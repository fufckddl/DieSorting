# 라벨링 클래스명 설명: "defect" vs "donut"

## 왜 donut 폴더에서도 클래스명을 "defect"로 해야 하나요?

이는 **2단계 모델 구조** 때문입니다:

---

## 🎯 현재 아키텍처 설계

### Step A: YOLO 검출 모델 (위치 검출)
- **역할**: 이미지에서 **불량이 어디에 있는지**만 찾음
- **입력**: 웨이퍼/칩 이미지
- **출력**: 불량 위치 (bbox 좌표)
- **클래스**: **단일 클래스 "defect"** (불량이 있다/없다만 구분)

### Step C: 패턴 분류 모델 (패턴 분류)
- **역할**: 불량들의 **공간적 분포**를 보고 패턴 분류
- **입력**: Wafer-map (불량 위치들의 분포 맵)
- **출력**: 패턴 클래스 (donut, local, edge-ring 등)

---

## 📊 파이프라인 흐름

```
[원본 이미지 (donut 패턴)]
    ↓
[Step A: YOLO 검출]
  → 불량1 위치: (x1, y1) [클래스: "defect"]
  → 불량2 위치: (x2, y2) [클래스: "defect"]
  → 불량3 위치: (x3, y3) [클래스: "defect"]
    ↓
[Step B: Wafer-map 생성]
  → 불량들의 공간 분포를 128×128 그리드로 변환
    ↓
[Step C: 패턴 분류]
  → 분포 맵을 분석하여 "donut" 패턴으로 분류 ✅
```

---

## 💡 왜 이렇게 설계했나요?

### 이유 1: 역할 분리
- **YOLO**: "어디에 불량이 있는가?" (위치 검출)
- **패턴 분류**: "어떤 패턴인가?" (분포 패턴 인식)

### 이유 2: 데이터 효율성
- YOLO 학습: 모든 패턴의 이미지에서 "불량 위치"만 학습
- 하나의 검출 모델로 모든 패턴 처리 가능

### 이유 3: 정확도 향상
- 개별 불량 위치 검출은 YOLO가 전문
- 패턴 분류는 별도 모델이 더 정확

---

## 📝 라벨링 예시

### dataset/Donut/679360.jpg 이미지에서:

**라벨링 방법:**
1. 이미지에서 **불량 부분들을 박스로 표시**
2. 각 박스의 클래스명: **"defect"** 입력
3. 여러 불량이 있으면 각각 박스 그리기

**결과:**
```
679360.txt 파일:
0 0.3 0.5 0.1 0.1  # defect (정규화된 좌표)
0 0.7 0.6 0.08 0.08  # defect
0 0.5 0.3 0.12 0.12  # defect
```

**학습 후:**
- YOLO는 불량 위치를 검출 (클래스: "defect")
- 불량들의 분포를 보고 패턴 분류 모델이 "donut"으로 판단

---

## 🤔 다른 방법이 가능한가요?

### 옵션 1: YOLO에서도 패턴별 클래스 사용 (현재 구조와 다름)

만약 YOLO에서도 패턴을 구분하려면:
- 클래스: "donut-defect", "local-defect", "edge-ring-defect" 등
- 하지만 이것은 현재 2단계 아키텍처와 맞지 않음

### 옵션 2: 현재 구조 유지 (권장) ⭐

- **YOLO**: 모든 불량을 "defect"로 검출
- **패턴 분류**: 분포 맵 기반으로 패턴 판단

**장점:**
- 데이터 효율적
- 모델이 각자의 역할에 집중
- 더 정확한 검출 가능

---

## ✅ 결론

**"donut" 폴더에 있어도 라벨링 시 클래스명은 "defect"입니다.**

이유:
1. YOLO는 **위치 검출**만 담당 (어떤 패턴인지는 모름)
2. **패턴 분류**는 Step C에서 수행 (불량 분포 맵 기반)
3. 이렇게 하면 더 정확하고 효율적

**라벨링 시:**
- ✅ 클래스명: **"defect"** (모든 패턴 폴더에서 동일)
- ❌ 클래스명: "donut" (X - YOLO가 패턴을 구분하지 않음)


